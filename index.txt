<?php

// 1. Incluir el controlador necesario
// En un proyecto real, necesitarías un "autoloader" o incluir todos los controladores
require_once 'controllers/OfertaController.php';

// 2. Obtener la URI y el método HTTP
$requestUri = $_SERVER['REQUEST_URI'];
$requestMethod = $_SERVER['REQUEST_METHOD'];

// 3. Limpiar y segmentar la URI
// Esta es la parte más importante para entender el enrutamiento
$uriSegments = explode('/', trim($requestUri, '/'));
$controllerName = $uriSegments[0] ?? '';
$actionName = $uriSegments[1] ?? '';
$id = $uriSegments[2] ?? null;

// Ejemplo de cómo se verían las variables para la URL http://localhost/ofertas/show/123
// $controllerName = 'ofertas'
// $actionName = 'show'
// $id = '123'

// 4. Lógica de enrutamiento
// Aquí es donde decides qué controlador y método ejecutar
if ($controllerName === 'ofertas') {
    // Si la URI tiene el segmento 'ofertas', creamos el controlador
    $controller = new OfertaController();

    // Ahora, basándonos en el siguiente segmento, llamamos al método adecuado
    if ($actionName === 'show' && $id) {
        $controller->show($id);
    } elseif ($actionName === 'index') {
        $controller->index();
    } else {
        // Si la acción no existe o es incorrecta, mostramos un error 404
        http_response_code(404);
        echo 'Página no encontrada';
    }
} else {
    // Si la URI no es 'ofertas', mostramos un error 404
    http_response_code(404);
    echo 'Página no encontrada';
}